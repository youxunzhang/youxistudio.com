<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>新游数据维护 | Shadowmilk Scratch</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-slate-50 text-slate-800 min-h-screen">
  <header class="site-header">
    <div class="container header-inner">
      <a class="logo" href="index.html">Shadowmilk Scratch</a>
      <nav class="site-nav" aria-label="主要导航">
        <a href="index.html">首页</a>
        <a href="latest-games.html">最新游戏</a>
        <a href="newgame.html">新游速递</a>
        <a href="newgameedit.html" aria-current="page">新游维护</a>
        <a href="game-sites.html">游戏站榜单</a>
        <a href="game-navigation.html">软件导航</a>
      </nav>
    </div>
  </header>

  <main class="container py-10">
    <section class="mb-8">
      <h1 class="text-3xl font-semibold mb-2">新游数据维护</h1>
      <p class="text-slate-600">对 <code>img-newgame/youxistudio-newgames.json</code> 进行增删改查与导入导出操作，维护最新的展示内容。</p>
      <p id="statusMessage" class="mt-2 text-sm text-slate-500" aria-live="polite">正在加载数据…</p>
    </section>

    <section class="flex flex-wrap items-center gap-3 mb-6">
      <div class="flex items-center gap-2 bg-white border rounded-xl px-3 py-2 shadow-sm">
        <span class="text-sm text-slate-500">搜索</span>
        <input id="searchInput" type="search" placeholder="名称、链接等" class="text-sm border-0 focus:ring-0" />
      </div>
      <button id="btnAdd" class="px-4 py-2 text-sm rounded-xl bg-blue-600 text-white hover:bg-blue-500">➕ 新增游戏</button>
      <label class="px-4 py-2 text-sm rounded-xl border bg-white hover:bg-slate-50 cursor-pointer shadow-sm">
        📂 导入 JSON
        <input id="fileInput" type="file" accept="application/json" class="hidden" />
      </label>
      <button id="btnDownload" class="px-4 py-2 text-sm rounded-xl border bg-white hover:bg-slate-50 shadow-sm">💾 导出当前 JSON</button>
      <span class="text-xs text-slate-400">（提示：导出后将下载修改后的 JSON 文件，手动替换服务器文件即可生效）</span>
    </section>

    <section class="bg-white border rounded-2xl shadow-sm overflow-hidden">
      <div class="overflow-x-auto">
        <table class="min-w-full text-sm">
          <thead class="bg-slate-100 text-slate-600">
            <tr>
              <th class="px-4 py-3 text-left">名称</th>
              <th class="px-4 py-3 text-left">封面地址</th>
              <th class="px-4 py-3 text-left">跳转链接</th>
              <th class="px-4 py-3 text-left">类型</th>
              <th class="px-4 py-3 text-right">操作</th>
            </tr>
          </thead>
          <tbody id="gamesBody" class="divide-y"></tbody>
        </table>
      </div>
      <div id="emptyState" class="hidden text-center text-slate-500 text-sm py-10">暂无数据，点击“新增游戏”开始维护。</div>
    </section>
  </main>

  <div id="editorDialog" class="hidden fixed inset-0 z-20 flex items-center justify-center">
    <div class="absolute inset-0 bg-black/40" data-action="close"></div>
    <div class="relative bg-white rounded-2xl shadow-xl w-full max-w-xl mx-4 p-6">
      <h2 id="dialogTitle" class="text-xl font-semibold mb-4">新增游戏</h2>
      <form id="gameForm" class="space-y-4">
        <div>
          <label for="fieldName" class="block text-sm font-medium text-slate-600 mb-1">名称</label>
          <input id="fieldName" name="name" type="text" required class="w-full border rounded-xl px-3 py-2 focus:ring-2 focus:ring-blue-200" />
        </div>
        <div>
          <label for="fieldImage" class="block text-sm font-medium text-slate-600 mb-1">封面地址</label>
          <input id="fieldImage" name="image" type="text" required class="w-full border rounded-xl px-3 py-2 focus:ring-2 focus:ring-blue-200" placeholder="例如：img-newgame/sample.jpg" />
        </div>
        <div>
          <label for="fieldLink" class="block text-sm font-medium text-slate-600 mb-1">跳转链接</label>
          <input id="fieldLink" name="link" type="url" required class="w-full border rounded-xl px-3 py-2 focus:ring-2 focus:ring-blue-200" placeholder="https://" />
        </div>
        <div>
          <label for="fieldType" class="block text-sm font-medium text-slate-600 mb-1">类型</label>
          <input id="fieldType" name="type" type="text" required class="w-full border rounded-xl px-3 py-2 focus:ring-2 focus:ring-blue-200" value="newgame" />
        </div>
        <div class="flex justify-end gap-3 pt-4">
          <button type="button" id="btnCancel" class="px-4 py-2 rounded-xl border bg-white hover:bg-slate-50">取消</button>
          <button type="submit" class="px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-500">保存</button>
        </div>
      </form>
    </div>
  </div>

  <footer class="site-footer mt-16">
    <div class="container footer-inner">
      <p>Shadowmilk Scratch Arcade · 一起守护 Scratch 的创意与乐趣</p>
      <div class="footer-links">
        <a href="https://scratch.mit.edu/parents" target="_blank" rel="noopener">家长指引</a>
        <a href="https://scratch.mit.edu/community_guidelines" target="_blank" rel="noopener">社区守则</a>
        <a href="mailto:hello@shadowmilk.org">联系站长</a>
      </div>
    </div>
  </footer>

  <script src="newgameedit.js"></script>
</body>
</html>
